{"ast":null,"code":"import _toConsumableArray from \"D:/temki/grimace/GrimaceSwap/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _createForOfIteratorHelper from \"D:/temki/grimace/GrimaceSwap/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\n/**\n * MIT License\n *\n * Copyright (c) 2021 Andrew Raffensperger\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n * This is a near carbon-copy of the original source (link below) with the\n * TypeScript typings added and a few tweaks to make it ES3-compatible.\n *\n * See: https://github.com/adraffy/ens-normalize.js\n */\nimport { toUtf8CodePoints } from \"@ethersproject/strings\";\nimport { getData } from './include.js';\nvar r = getData();\nimport { read_member_array, read_mapped_map, read_emoji_trie } from './decoder.js';\n// @TODO: This should be lazily loaded\nvar VALID = new Set(read_member_array(r));\nvar IGNORED = new Set(read_member_array(r));\nvar MAPPED = read_mapped_map(r);\nvar EMOJI_ROOT = read_emoji_trie(r);\n//const NFC_CHECK = new Set(read_member_array(r, Array.from(VALID.values()).sort((a, b) => a - b)));\n//const STOP = 0x2E;\nvar HYPHEN = 0x2D;\nvar UNDERSCORE = 0x5F;\nfunction explode_cp(name) {\n  return toUtf8CodePoints(name);\n}\nfunction filter_fe0f(cps) {\n  return cps.filter(function (cp) {\n    return cp != 0xFE0F;\n  });\n}\nexport function ens_normalize_post_check(name) {\n  var _iterator = _createForOfIteratorHelper(name.split('.')),\n    _step;\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var label = _step.value;\n      var cps = explode_cp(label);\n      try {\n        for (var i = cps.lastIndexOf(UNDERSCORE) - 1; i >= 0; i--) {\n          if (cps[i] !== UNDERSCORE) {\n            throw new Error(\"underscore only allowed at start\");\n          }\n        }\n        if (cps.length >= 4 && cps.every(function (cp) {\n          return cp < 0x80;\n        }) && cps[2] === HYPHEN && cps[3] === HYPHEN) {\n          throw new Error(\"invalid label extension\");\n        }\n      } catch (err) {\n        throw new Error(\"Invalid label \\\"\".concat(label, \"\\\": \").concat(err.message));\n      }\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n  return name;\n}\nexport function ens_normalize(name) {\n  return ens_normalize_post_check(normalize(name, filter_fe0f));\n}\nfunction normalize(name, emoji_filter) {\n  var input = explode_cp(name).reverse(); // flip for pop\n  var output = [];\n  while (input.length) {\n    var emoji = consume_emoji_reversed(input);\n    if (emoji) {\n      output.push.apply(output, _toConsumableArray(emoji_filter(emoji)));\n      continue;\n    }\n    var cp = input.pop();\n    if (VALID.has(cp)) {\n      output.push(cp);\n      continue;\n    }\n    if (IGNORED.has(cp)) {\n      continue;\n    }\n    var cps = MAPPED[cp];\n    if (cps) {\n      output.push.apply(output, _toConsumableArray(cps));\n      continue;\n    }\n    throw new Error(\"Disallowed codepoint: 0x\".concat(cp.toString(16).toUpperCase()));\n  }\n  return ens_normalize_post_check(nfc(String.fromCodePoint.apply(String, output)));\n}\nfunction nfc(s) {\n  return s.normalize('NFC');\n}\nfunction consume_emoji_reversed(cps, eaten) {\n  var _a;\n  var node = EMOJI_ROOT;\n  var emoji;\n  var saved;\n  var stack = [];\n  var pos = cps.length;\n  if (eaten) eaten.length = 0; // clear input buffer (if needed)\n  var _loop = function _loop() {\n    var cp = cps[--pos];\n    node = (_a = node.branches.find(function (x) {\n      return x.set.has(cp);\n    })) === null || _a === void 0 ? void 0 : _a.node;\n    if (!node) return \"break\";\n    if (node.save) {\n      // remember\n      saved = cp;\n    } else if (node.check) {\n      // check exclusion\n      if (cp === saved) return \"break\";\n    }\n    stack.push(cp);\n    if (node.fe0f) {\n      stack.push(0xFE0F);\n      if (pos > 0 && cps[pos - 1] == 0xFE0F) pos--; // consume optional FE0F\n    }\n\n    if (node.valid) {\n      // this is a valid emoji (so far)\n      emoji = stack.slice(); // copy stack\n      if (node.valid == 2) emoji.splice(1, 1); // delete FE0F at position 1 (RGI ZWJ don't follow spec!)\n      if (eaten) eaten.push.apply(eaten, _toConsumableArray(cps.slice(pos).reverse())); // copy input (if needed)\n      cps.length = pos; // truncate\n    }\n  };\n  while (pos) {\n    var _ret = _loop();\n    if (_ret === \"break\") break;\n  }\n  return emoji;\n}","map":{"version":3,"names":["toUtf8CodePoints","getData","r","read_member_array","read_mapped_map","read_emoji_trie","VALID","Set","IGNORED","MAPPED","EMOJI_ROOT","HYPHEN","UNDERSCORE","explode_cp","name","filter_fe0f","cps","filter","cp","ens_normalize_post_check","_iterator","_createForOfIteratorHelper","split","_step","s","n","done","label","value","i","lastIndexOf","Error","length","every","err","concat","message","e","f","ens_normalize","normalize","emoji_filter","input","reverse","output","emoji","consume_emoji_reversed","push","apply","_toConsumableArray","pop","has","toString","toUpperCase","nfc","String","fromCodePoint","eaten","node","saved","stack","pos","_loop","_a","branches","find","x","set","save","check","fe0f","valid","slice","splice","_ret"],"sources":["D:\\temki\\grimace\\GrimaceSwap\\node_modules\\@ethersproject\\hash\\src.ts\\ens-normalize\\lib.ts"],"sourcesContent":["/**\n * MIT License\n *\n * Copyright (c) 2021 Andrew Raffensperger\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n *\n * This is a near carbon-copy of the original source (link below) with the\n * TypeScript typings added and a few tweaks to make it ES3-compatible.\n *\n * See: https://github.com/adraffy/ens-normalize.js\n */\n\nimport { toUtf8CodePoints } from \"@ethersproject/strings\";\n\nimport { getData } from './include.js';\nconst r = getData();\n\nimport {read_member_array, read_mapped_map, read_emoji_trie} from './decoder.js';\n\n// @TODO: This should be lazily loaded\n\nconst VALID = new Set(read_member_array(r));\nconst IGNORED = new Set(read_member_array(r));\nconst MAPPED = read_mapped_map(r);\nconst EMOJI_ROOT = read_emoji_trie(r);\n//const NFC_CHECK = new Set(read_member_array(r, Array.from(VALID.values()).sort((a, b) => a - b)));\n\n//const STOP = 0x2E;\nconst HYPHEN = 0x2D;\nconst UNDERSCORE = 0x5F;\n\nfunction explode_cp(name: string): Array<number> {\n    return toUtf8CodePoints(name);\n}\n\nfunction filter_fe0f(cps: Array<number>): Array<number> {\n    return cps.filter(cp => cp != 0xFE0F);\n}\n\nexport function ens_normalize_post_check(name: string): string {\n\tfor (let label of name.split('.')) {\n\t\tlet cps = explode_cp(label);\n\t\ttry {\n\t\t\tfor (let i = cps.lastIndexOf(UNDERSCORE) - 1; i >= 0; i--) {\n\t\t\t\tif (cps[i] !== UNDERSCORE) {\n\t\t\t\t\tthrow new Error(`underscore only allowed at start`);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (cps.length >= 4 && cps.every(cp => cp < 0x80) && cps[2] === HYPHEN && cps[3] === HYPHEN) {\n\t\t\t\tthrow new Error(`invalid label extension`);\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tthrow new Error(`Invalid label \"${label}\": ${err.message}`);\n\t\t}\n\t}\n\treturn name;\n}\n\nexport function ens_normalize(name: string): string {\n\treturn ens_normalize_post_check(normalize(name, filter_fe0f));\n}\n\nfunction normalize(name: string, emoji_filter: (a: Array<number>) => Array<number>): string {\n\tlet input = explode_cp(name).reverse(); // flip for pop\n\tlet output = [];\n\twhile (input.length) {\t\t\n\t\tlet emoji = consume_emoji_reversed(input);\n\t\tif (emoji) {\n\t\t\toutput.push(...emoji_filter(emoji));\n\t\t\tcontinue;\n\t\t}\n\t\tlet cp = input.pop();\n\t\tif (VALID.has(cp)) {\n\t\t\toutput.push(cp);\n\t\t\tcontinue;\n\t\t} \n\t\tif (IGNORED.has(cp)) {\n\t\t\tcontinue;\n\t\t}\n\t\tlet cps = MAPPED[cp];\n\t\tif (cps) {\n\t\t\toutput.push(...cps);\n\t\t\tcontinue;\n\t\t}\n\t\tthrow new Error(`Disallowed codepoint: 0x${cp.toString(16).toUpperCase()}`);\n\t}\n\treturn ens_normalize_post_check(nfc(String.fromCodePoint(...output)));\n}\n\nfunction nfc(s: string): string {\n    return s.normalize('NFC');\n}\n\nfunction consume_emoji_reversed(cps: Array<number>, eaten?: Array<number>) {\n\tlet node = EMOJI_ROOT;\n\tlet emoji;\n\tlet saved;\n\tlet stack = [];\n\tlet pos = cps.length;\n\tif (eaten) eaten.length = 0; // clear input buffer (if needed)\n\twhile (pos) {\n\t\tlet cp = cps[--pos];\n\t\tnode = node.branches.find(x => x.set.has(cp))?.node;\n\t\tif (!node) break;\n\t\tif (node.save) { // remember\n\t\t\tsaved = cp;\n\t\t} else if (node.check) { // check exclusion\n\t\t\tif (cp === saved) break;\n\t\t}\n\t\tstack.push(cp);\n\t\tif (node.fe0f) {\n\t\t\tstack.push(0xFE0F);\n\t\t\tif (pos > 0 && cps[pos - 1] == 0xFE0F) pos--; // consume optional FE0F\n\t\t}\n\t\tif (node.valid) { // this is a valid emoji (so far)\n\t\t\temoji = stack.slice(); // copy stack\n\t\t\tif (node.valid == 2) emoji.splice(1, 1); // delete FE0F at position 1 (RGI ZWJ don't follow spec!)\n\t\t\tif (eaten) eaten.push(...cps.slice(pos).reverse()); // copy input (if needed)\n\t\t\tcps.length = pos; // truncate\n\t\t}\n\t}\n\treturn emoji;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}